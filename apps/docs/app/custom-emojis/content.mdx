import { BookOpen } from "lucide-react";
import { Alert, AlertDescription } from "@/components/ui/alert";

# Custom Emojis

Welcome to the **Custom Emojis**!  
This page will walk you through the basic usage of custom emoji.

<Alert variant="default" className="flex gap-2 items-start ">
  <span className="flex-shrink-0 leading-none mt-1.5">
    <BookOpen className="size-[1em] align-middle" />
  </span>
  <AlertDescription className="[&>*]:m-0">
    If you havenâ€™t installed anything yet, please follow the steps in the [Usage
    Guide](/usage) before proceeding.
  </AlertDescription>
</Alert>

---

<section>

<H2
  iconUrl="https://ofqhpepsytodemxfrhrc.supabase.co/storage/v1/object/public/tiptap-extension-twemoji-assets/okabe.jpg"
  iconAlt="okabe"
  iconClassName="rounded"
>
  Predefined Custom Emojis
</H2>

Using Predefined Custom Emojis

```tsx
// components/Editor.tsx
import * as React from "react";
import { useEditor } from "@tiptap/react";
import { StarterKit } from "@tiptap/starter-kit";
import {
  TwemojiExtension,
  CustomEmoji,
} from "@raihancodes/tiptap-extension-twemoji-react";

export default function Editor() {
  const editor = useEditor({
    extensions: [StarterKit, TwemojiExtension],
    content: "<p>Hello World!</p>",
    immediatelyRender: false,
  });

  const customEmojis: CustomEmoji[] = [
    {
      id: "8177849e-c2c9-424a-a914-ff128ce439c5",
      label: "github-icon",
      url: "...",
    },
    {
      id: "cecf7043-80da-4e3f-b167-6a85de0e464a",
      label: "npm-icon",
      url: "...",
    },
  ];

  React.useEffect(() => {
    if (editor) {
      editor.commands.updateCustomEmojis(customEmojis);
    }
  }, [editor]);

  return <EditorContent editor={editor} />;
}
```

</section>

---

<section>

<H2
  iconUrl="https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/1f5c4.svg"
  iconAlt="ðŸ—„ï¸"
  iconClassName="rounded"
>
  Database Custom Emojis
</H2>

### Fetching Example

```tsx
// page.tsx
import { CustomEmoji } from "@raihancodes/tiptap-extension-twemoji-react";

export default async function Page() {
  // Fetch from your database / API / data source
  const { data, error } = await fetchFromDatabase("custom-emojis");

  if (error) {
    console.error("Error fetching emojis:", error);
  }

  const customEmojis = (data ?? []) as CustomEmoji[];

  return <Editor customEmojis={customEmojis} />;
}
```

### Upload & Apply Emojis

Handling Emoji Uploads and Applying Fetched Emojis

```tsx
"use client";

// components/Editor.tsx

import * as React from "react";
import { useEditor } from "@tiptap/react";
import { StarterKit } from "@tiptap/starter-kit";
import {
  EmojiUploadProps,
  TwemojiExtension,
  CustomEmoji,
} from "@raihancodes/tiptap-extension-twemoji-react";

export default function Editor({
  customEmojis,
}: {
  customEmojis: CustomEmoji[];
}) {
  const handleEmojiUpload: EmojiUploadProps["upload"] = async ({
    emojiName,
    file,
    handleSuccess,
    handleError,
    dismiss,
  }) => {
    // Upload to your server / S3 / Supabase
    const res = await uploadToServer(file);
    if (res.ok) {
      handleSuccess(res.message, dismiss);
    } else {
      handleError(res.message);
    }
  };

  const handleEmojiOnSuccess: EmojiUploadProps["onSuccess"] = (
    successMessage,
    callback
  ) => {
    console.log(successMessage);
    callback?.();
    router.refresh(); // optional
  };

  const handleEmojiOnError: EmojiUploadProps["onError"] = (errorMessage) => {
    console.error(errorMessage);
  };

  const editor = useEditor({
    extensions: [
      StarterKit,
      TwemojiExtension.configure({
        customEmojiOptions: {
          upload: handleEmojiUpload,
          onSuccess: handleEmojiOnSuccess,
          onError: handleEmojiOnError,
        },
      }),
    ],
    content: "<p>Hello World!</p>",
    immediatelyRender: false,
  });

  // Applying Fetched Emojis
  React.useEffect(() => {
    if (editor) {
      editor.commands.updateCustomEmojis(customEmojis);
    }
  }, [editor, customEmojis]);

  return <EditorContent editor={editor} />;
}
```

Choose the approach that best fits your needs

</section>

---

<section>

<H2
  iconUrl="https://cdn.jsdelivr.net/gh/primer/octicons@16.1.1/icons/mark-github-16.svg"
  iconAlt="github"
  iconClassName="bg-white p-0.5 rounded"
>
  Quick Demo
</H2>

For more details, check the [example repo on GitHub](https://github.com/raihan-ramadhan/tiptap-extension-twemoji/tree/master/apps/example)

</section>

---

<section>

<H2
  iconUrl="https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/1f680.svg"
  iconAlt="ðŸš€"
>
  Whatâ€™s Next?
</H2>

- ðŸ‘‰ Check out the [Deep Dive](/deep-dive) section to learn how to customize the extensionâ€”header, navigation, cell size, custom emojis, etc.

</section>
